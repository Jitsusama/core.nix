--- a/lua/claudecode/diff.lua
+++ b/lua/claudecode/diff.lua
@@ -81,7 +81,11 @@
     local buftype = vim.api.nvim_buf_get_option(buf, "buftype")
 
     if buftype == "terminal" or buftype == "nofile" then
-      vim.cmd("vsplit")
+      if config and config.diff_opts and config.diff_opts.vertical_split == false then
+        vim.cmd("split")
+      else
+        vim.cmd("vsplit")
+      end
     end
   end
 
@@ -95,7 +99,11 @@
 
   vim.cmd("edit " .. vim.fn.fnameescape(old_file_path))
   vim.cmd("diffthis")
-  vim.cmd("vsplit")
+  if config and config.diff_opts and config.diff_opts.vertical_split == false then
+    vim.cmd("split")
+  else
+    vim.cmd("vsplit")
+  end
   vim.cmd("edit " .. vim.fn.fnameescape(tmp_file))
   vim.api.nvim_buf_set_name(0, new_file_path .. " (New)")
 
@@ -168,7 +176,11 @@
     local filetype = vim.api.nvim_buf_get_option(buf, "filetype")
 
     if buftype == "terminal" or buftype == "prompt" or filetype == "neo-tree" then
-      vim.cmd("vsplit")
+      if config and config.diff_opts and config.diff_opts.vertical_split == false then
+        vim.cmd("split")
+      else
+        vim.cmd("vsplit")
+      end
     end
 
     target_window = vim.api.nvim_get_current_win()
@@ -196,7 +208,11 @@
 
   vim.cmd("diffthis")
 
-  vim.cmd("vsplit")
+  if config and config.diff_opts and config.diff_opts.vertical_split == false then
+    vim.cmd("split")
+  else
+    vim.cmd("vsplit")
+  end
   local new_win = vim.api.nvim_get_current_win()
   vim.api.nvim_win_set_buf(new_win, new_buffer)